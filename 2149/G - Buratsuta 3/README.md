<h3><a href="https://codeforces.com/contest/2149/problem/G" target="_blank" rel="noopener noreferrer">Buratsuta 3</a></h3>

<div class="header"><div class="title">G. Buratsuta 3</div><div class="time-limit"><div class="property-title">time limit per test</div>4.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p>In the ruthless world of Blue Lock, <span class="tex-font-style-it">Buratsuta 3</span> is a trio selected to overthrow the reigning champions and lead the Japan U-20 team to glory. <span class="tex-font-style-it">Sae Itoshi</span> has already secured his place as the first participant; the remaining two spots will be contested in the tough Side-B selection.</p><p>To test the strategic abilities of the candidates, Buratsuta has posed the following challenge:</p><p>You are given an array of $$$n$$$ integers called "performance records" and $$$q$$$ queries. Each query specifies a subarray $$$[l, r]$$$. In this subarray, find all record values that occur <span class="tex-font-style-bf">strictly more</span> than $$$\lfloor\tfrac{r - l + 1}{3}\rfloor$$$ times.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Each test consists of several test cases.</p><p>The first line contains a single integer $$$t$$$ ($$$1 \le t \le 10^4$$$) — the number of test cases.</p><p>The following describes the test cases.</p><p>The first line of each test case contains two integers $$$n$$$ and $$$q$$$ $$$(1 \le n, q \le 2\cdot10^5)$$$ — the number of records and the number of queries.</p><p>The second line of each test case contains $$$n$$$ integers $$$a_1, a_2, \dots, a_n$$$ $$$(1 \le a_i \le 10^9)$$$ — the performance records.</p><p>Each of the following $$$q$$$ lines contains two integers $$$l$$$ and $$$r$$$ $$$(1 \le l \le r \le n)$$$ — the boundaries of the query.</p><p>It is guaranteed that the sum of $$$n$$$ and sum of $$$q$$$ over all test cases does not exceed $$$2 \cdot 10^5$$$.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query, output in one line all record values (in sorted order) that occur <span class="tex-font-style-bf">strictly more</span> than $$$\lfloor\tfrac{r - l + 1}{3}\rfloor$$$ times in the segment $$$[l, r]$$$. If there are no such values, output $$$-1$$$.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id005039197947651053" id="id0018146863208993758" class="input-output-copier">Copy</div></div><pre id="id005039197947651053"><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-odd test-example-line-1">1 1</div><div class="test-example-line test-example-line-odd test-example-line-1">5</div><div class="test-example-line test-example-line-odd test-example-line-1">1 1</div><div class="test-example-line test-example-line-even test-example-line-2">4 2</div><div class="test-example-line test-example-line-even test-example-line-2">1 1 2 3</div><div class="test-example-line test-example-line-even test-example-line-2">1 4</div><div class="test-example-line test-example-line-even test-example-line-2">2 3</div><div class="test-example-line test-example-line-odd test-example-line-3">6 3</div><div class="test-example-line test-example-line-odd test-example-line-3">7 7 7 8 8 9</div><div class="test-example-line test-example-line-odd test-example-line-3">1 6</div><div class="test-example-line test-example-line-odd test-example-line-3">2 5</div><div class="test-example-line test-example-line-odd test-example-line-3">4 6</div><div class="test-example-line test-example-line-even test-example-line-4">8 2</div><div class="test-example-line test-example-line-even test-example-line-4">4 4 4 5 5 5 6 6</div><div class="test-example-line test-example-line-even test-example-line-4">1 8</div><div class="test-example-line test-example-line-even test-example-line-4">3 6</div><div class="test-example-line test-example-line-odd test-example-line-5">10 5</div><div class="test-example-line test-example-line-odd test-example-line-5">1 2 3 3 3 4 4 4 4 5</div><div class="test-example-line test-example-line-odd test-example-line-5">1 10</div><div class="test-example-line test-example-line-odd test-example-line-5">1 5</div><div class="test-example-line test-example-line-odd test-example-line-5">4 9</div><div class="test-example-line test-example-line-odd test-example-line-5">6 9</div><div class="test-example-line test-example-line-odd test-example-line-5">7 10</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id003569148723814456" id="id0016374866513282615" class="input-output-copier">Copy</div></div><pre id="id003569148723814456"><div class="test-example-line test-example-line-odd test-example-line-1">5 </div><div class="test-example-line test-example-line-even test-example-line-2">1 </div><div class="test-example-line test-example-line-even test-example-line-2">1 2 </div><div class="test-example-line test-example-line-odd test-example-line-3">7 </div><div class="test-example-line test-example-line-odd test-example-line-3">7 8 </div><div class="test-example-line test-example-line-odd test-example-line-3">8 </div><div class="test-example-line test-example-line-even test-example-line-4">4 5 </div><div class="test-example-line test-example-line-even test-example-line-4">5 </div><div class="test-example-line test-example-line-odd test-example-line-5">4 </div><div class="test-example-line test-example-line-odd test-example-line-5">3 </div><div class="test-example-line test-example-line-odd test-example-line-5">4 </div><div class="test-example-line test-example-line-odd test-example-line-5">4 </div><div class="test-example-line test-example-line-odd test-example-line-5">4 </div></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the second test case, the array is $$$a=[1,1,2,3]$$$ and there are two queries: </p><ul> <li> Query $$$(l,r)=(1,4)$$$: The length of the segment $$$len=r-l+1=4$$$, the threshold $$$\bigl\lfloor \frac{len}{3}\bigr\rfloor+1 = 2$$$. Occurrences of numbers: $$$1\!\to\!2$$$, $$$2\!\to\!1$$$, $$$3\!\to\!1$$$. Only the number $$$1$$$ occurs at least $$$2$$$ times, so the answer is: $$$1$$$. </li><li> Query $$$(l,r)=(2,3)$$$: The length of the segment $$$len=2$$$, the threshold $$$\bigl\lfloor \frac{len}{3}\bigr\rfloor+1 = 1$$$. Numbers $$$1$$$ and $$$2$$$ occur once each, so the answer is: $$$1 \; 2$$$. </li></ul><p>In the fourth test case, the array is $$$a=[4,4,4,5,5,5,6,6]$$$ and there are two queries: </p><ul> <li> Query $$$(l,r)=(1,8)$$$: The length of the segment $$$len = 8$$$, the threshold $$$\bigl\lfloor \dfrac{len}{3} \bigr\rfloor + 1 = 3$$$. <p> Occurrences of numbers: $$$4 \!\to\! 3$$$, $$$5 \!\to\! 3$$$, $$$6 \!\to\! 2$$$. Only the numbers $$$4$$$ and $$$5$$$ occur at least $$$3$$$ times, so the answer is: $$$4 \; 5$$$. </p></li><li> Query $$$(l,r)=(3,6)$$$: The length of the segment $$$len = 4$$$, the threshold $$$\bigl\lfloor \dfrac{len}{3} \bigr\rfloor + 1 = 2$$$.<p> Occurrences of numbers: $$$4 \!\to\! 1$$$, $$$5 \!\to\! 3$$$. Only the number $$$5$$$ occurs at least $$$2$$$ times, so the answer is: $$$5$$$. </p></li></ul></div>