<h3><a href="https://codeforces.com/contest/2147/problem/G" target="_blank" rel="noopener noreferrer">Modular Tetration</a></h3>

<div class="header"><div class="title">G. Modular Tetration</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p> </p><p>For a positive integer $$$a$$$, we define a recurrence $$$\{b_n\}_{n\geq 0}$$$ as $$$b_n = a^{b_{n-1}}$$$, with $$$b_0 = 1$$$.</p><p>We say that a positive integer $$$a$$$ is $$$m$$$-<span class="tex-font-style-it">tetrative</span> if the sequence $$$b$$$ stabilizes to $$$1$$$ modulo $$$m$$$, that is, there exists $$$N \ge 0$$$ such that $$$b_n \equiv 1 \pmod m$$$ for all $$$n \geq N$$$.</p><p>For a given $$$m$$$, calculate the density of the $$$m$$$-<span class="tex-font-style-it">tetrative</span> integers. Here, the density of a set $$$S$$$ is the limit $$$$$$\lim\limits_{n\rightarrow \infty}\frac{|S\cap [1,2,\ldots,n]|}{n}.$$$$$$ Informally, it is the "proportion" of positive integers that are $$$m$$$-<span class="tex-font-style-it">tetrative</span>.</p><p>It can be proven (under the constraints of this problem) that the density is well-defined and is always a rational number, whose denominator is not divisible by $$$998\,244\,353$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \le t \le 10^4$$$). The description of the test cases follows. </p><p>The number $$$m$$$ will be given to you as a product of three integers $$$x$$$, $$$y$$$, and $$$z$$$. The first and only line of each test case contains three integers $$$x$$$, $$$y$$$, $$$z$$$ ($$$1\leq x,y,z \leq 10^6$$$, $$$m = xyz \geq 2$$$).</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case, print the density of $$$m$$$-<span class="tex-font-style-it">tetrative</span> integers ($$$a$$$ such that its corresponding sequence $$$b_n$$$ converges to $$$1$$$ modulo $$$m$$$), modulo $$$998\,244\,353$$$.</p><p>Formally, let $$$M = 998\,244\,353$$$. It can be shown that the exact answer can be expressed as an irreducible fraction $$$\frac{p}{q}$$$, where $$$p$$$ and $$$q$$$ are integers and $$$q \not \equiv 0 \pmod{M}$$$. Output the integer equal to $$$p \cdot q^{-1} \bmod M$$$. In other words, output such an integer $$$x$$$ that $$$0 \le x < M$$$ and $$$x \cdot q \equiv p \pmod{M}$$$. </p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id00028506543641921844" id="id007343999527933373" class="input-output-copier">Copy</div></div><pre id="id00028506543641921844"><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-odd test-example-line-1">5 1 1</div><div class="test-example-line test-example-line-even test-example-line-2">5 2 1</div><div class="test-example-line test-example-line-odd test-example-line-3">23 1 1</div><div class="test-example-line test-example-line-even test-example-line-4">10 10 2</div><div class="test-example-line test-example-line-odd test-example-line-5">9 3 37</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id0046561644063223717" id="id009359857014781522" class="input-output-copier">Copy</div></div><pre id="id0046561644063223717"><div class="test-example-line test-example-line-odd test-example-line-1">499122177</div><div class="test-example-line test-example-line-even test-example-line-2">299473306</div><div class="test-example-line test-example-line-odd test-example-line-3">893685162</div><div class="test-example-line test-example-line-even test-example-line-4">913393583</div><div class="test-example-line test-example-line-odd test-example-line-5">705965601</div></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test case, $$$m = 5$$$. For example, $$$a=1$$$ is $$$5$$$-<span class="tex-font-style-it">tetrative</span> since $$$b_n = 1$$$ for all $$$n$$$. For $$$a= 8$$$, the sequence $$$b$$$ is $$$[1, 8, 8^8, 8^{(8^8)}, \ldots]$$$, which is $$$[1, 3, 1, 1, \ldots]$$$ if we look at it modulo $$$5$$$. It can be proven that the sequence is always $$$1 \pmod 5$$$ for big enough $$$n$$$, so $$$8$$$ is $$$5$$$-<span class="tex-font-style-it">tetrative</span>. For $$$a=10$$$, the sequence $$$b$$$ is $$$[1, 10, 10^{10}, 10^{(10^{10})}, \ldots]$$$, which is $$$[1, 0, 0, 0, \ldots]$$$ if we look at it modulo $$$5$$$. It can be proven that the sequence is always $$$0 \pmod 5$$$ for big enough $$$n$$$, so $$$10$$$ is not $$$5$$$-<span class="tex-font-style-it">tetrative</span>. The answer for the first test case is $$$\frac{1}{2}$$$.</p><p> In the second test case, $$$m= 10$$$ and the answer is $$$\frac{1}{10}$$$. </p><p> In the third test case, $$$m= 23$$$ and the answer is $$$\frac{63}{506}$$$.</p><p> In the fourth test case, $$$m= 200$$$ and the answer is $$$\frac{1}{200}$$$. </p><p> In the fifth test case, $$$m= 999$$$ and the answer is $$$\frac{1}{222}$$$.</p></div>