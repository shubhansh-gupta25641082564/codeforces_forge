<h3><a href="https://codeforces.com/contest/2147/problem/H" target="_blank" rel="noopener noreferrer">Maxflow GCD Coloring</a></h3>

<div class="header"><div class="title">H. Maxflow GCD Coloring</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p> </p><p>Consider an undirected graph $$$G$$$ with $$$n$$$ vertices and positive integer capacities on its edges. We denote by $$$\textsf{maxflow}(u, v)$$$ the value of the <a href="https://en.wikipedia.org/wiki/Maximum_flow_problem">maximum flow</a> in the graph from source $$$u$$$ to sink $$$v$$$. We say that such a graph $$$G$$$ is <span class="tex-font-style-it">good</span> if there exists a positive integer $$$d \geq 2$$$ such that $$$d$$$ divides each of the $$$n \cdot (n-1)$$$ values of $$$\textsf{maxflow}(u, v)$$$ for all pairs $$$(u, v)$$$ of distinct vertices of $$$G$$$. Note that, in particular, any graph without edges is good. </p><p>You are given a graph, and you have to color its vertices so that, for each color, the subgraph induced$$$^{\text{∗}}$$$ by the vertices of that color is good. Find such a coloring with the <span class="tex-font-style-bf">minimum</span> possible number of colors.</p><div class="statement-footnote"><p>$$$^{\text{∗}}$$$Subgraph induced by a set of vertices $$$S$$$ is another graph, whose vertices are $$$S$$$ and whose edges are <span class="tex-font-style-bf">all</span> of the edges, from the original graph, connecting pairs of vertices in $$$S$$$.</p></div></div><div class="input-specification"><div class="section-title">Input</div><p>Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \le t \le 1000$$$). The description of the test cases follows. </p><p>The first line of each test case contains two integers $$$n$$$ and $$$m$$$ ($$$1 \leq n \leq 50$$$, $$$0 \leq m \leq \frac{n(n-1)}{2}$$$), the number of vertices and the number of edges of the graph.</p><p>The next $$$m$$$ lines each contain three integers $$$u$$$, $$$v$$$, $$$w$$$ ($$$1 \leq u, v \leq n$$$, $$$1 \leq w \leq 10^6$$$), denoting that there is an edge connecting vertices $$$u$$$ and $$$v$$$ with capacity $$$w$$$. It is guaranteed that there are no self-loops or multiple edges between the same vertices.</p><p>It is guaranteed that the sum of $$$n^4$$$ over all test cases does not exceed $$$50^4$$$. </p><p>It can be shown that other limitations imply that the sum of $$$m$$$ over all test cases does not exceed $$$50\,000$$$, so you don't need to worry about the size of the input.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case, output one integer $$$c$$$, the minimum possible number of colors. Then, output $$$2c$$$ lines, describing the coloring. For each $$$1 \leq i \leq c$$$, you must output two lines: one line with the number of vertices $$$k_i$$$ colored with the $$$i$$$-th color, followed by one line with $$$k_i$$$ integers, the vertices colored with the $$$i$$$-th color. </p><p>If there are multiple solutions, print any of them.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id006952013816926174" id="id007604059665661409" class="input-output-copier">Copy</div></div><pre id="id006952013816926174"><div class="test-example-line test-example-line-even test-example-line-0">2</div><div class="test-example-line test-example-line-odd test-example-line-1">5 5</div><div class="test-example-line test-example-line-odd test-example-line-1">1 2 2</div><div class="test-example-line test-example-line-odd test-example-line-1">2 3 3</div><div class="test-example-line test-example-line-odd test-example-line-1">3 4 4</div><div class="test-example-line test-example-line-odd test-example-line-1">4 5 5</div><div class="test-example-line test-example-line-odd test-example-line-1">5 1 6</div><div class="test-example-line test-example-line-even test-example-line-2">6 7</div><div class="test-example-line test-example-line-even test-example-line-2">1 2 2</div><div class="test-example-line test-example-line-even test-example-line-2">1 3 2</div><div class="test-example-line test-example-line-even test-example-line-2">1 4 2</div><div class="test-example-line test-example-line-even test-example-line-2">2 5 1</div><div class="test-example-line test-example-line-even test-example-line-2">3 5 1</div><div class="test-example-line test-example-line-even test-example-line-2">4 5 1</div><div class="test-example-line test-example-line-even test-example-line-2">5 6 6</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id00049730783212432184" id="id007044936988005105" class="input-output-copier">Copy</div></div><pre id="id00049730783212432184"><div class="test-example-line test-example-line-odd test-example-line-1">2</div><div class="test-example-line test-example-line-odd test-example-line-1">2</div><div class="test-example-line test-example-line-odd test-example-line-1">2 4</div><div class="test-example-line test-example-line-odd test-example-line-1">3</div><div class="test-example-line test-example-line-odd test-example-line-1">1 3 5</div><div class="test-example-line test-example-line-even test-example-line-2">1</div><div class="test-example-line test-example-line-even test-example-line-2">6</div><div class="test-example-line test-example-line-even test-example-line-2">1 2 3 4 5 6</div></pre></div></div></div><div class="note"><div class="section-title">Note</div><p><a href="https://codeforces.com/assets/contests/2147/H_BpBMojEo8HY7badOmJkt.html">Visualizer link</a></p><p>In the answer to the first test case, the subgraph induced by the first color has no edges, and the subgraph induced by the second color has only one edge with capacity $$$6$$$; therefore, both subgraphs are good.</p><p>In the second test case, the whole graph is good since the value of $$$\mathsf{maxflow}$$$ between any pair of vertices is divisible by $$$3$$$.</p></div>