<h3><a href="https://codeforces.com/contest/2140/problem/E2" target="_blank" rel="noopener noreferrer">Prime Gaming (Hard Version)</a></h3>

<div class="header"><div class="title">E2. Prime Gaming (Hard Version)</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>512 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p>  </p><p><span class="tex-font-style-bf">This is the hard version of the problem. The difference between the versions is that in this version, $$$m \le 10^6$$$. You can hack only if you solved all versions of this problem.</span> </p><p>A <span class="tex-font-style-it">valid</span> configuration is defined as an arrangement of $$$n$$$ piles of stones such that:</p><ul> <li> The number of stones in each pile is an integer between $$$1$$$ and $$$m$$$ (both inclusive). </li></ul><p>Given a <span class="tex-font-style-it">valid</span> configuration of $$$n$$$ piles of stones, <span class="tex-font-style-bf">some indices from $$$1$$$ to $$$n$$$ are marked as good</span>. Alice and Bob start playing a game taking $$$n-1$$$ turns alternately with Alice going first. In each turn, they have to perform the following operation:</p><ul> <li> Choose any integer $$$i$$$ such that $$$1 \le i \le p$$$ (where $$$p$$$ is the number of piles left) and $$$i$$$ is <span class="tex-font-style-bf">good</span>, and remove the $$$i$$$-th pile completely. </li></ul><p>Note that after performing the operation once, the number of piles decreases by $$$1$$$ and the remaining piles are re-indexed. The game will end when there is only one pile left. It is guaranteed that the index $$$1$$$ is always good.</p><p>Let $$$x$$$ denote the number of stones in the final remaining pile. Alice wants to maximize $$$x$$$, whereas Bob wants to minimize it. Both Alice and Bob play optimally.</p><p>Find the sum of $$$x$$$ over all the possible <span class="tex-font-style-it">valid</span> configurations modulo $$$10 ^ 9 + 7$$$.</p></div><div class="input-specification"><div class="section-title">Input</div><p>Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \le t \le 10^4$$$). The description of the test cases follows. </p><p>The first line of each testcase contains two integers $$$n$$$ ($$$1 \le n \le 20$$$) and $$$m$$$ ($$$1 \le m \le 10^6$$$) — the number of piles and the upper bound on the number of stones in a pile.</p><p>The second line of each testcase contains a single integer $$$k$$$ ($$$1 \le k \le n$$$) — the number of indices marked as good.</p><p>The third line of each testcase contains $$$k$$$ integers $$$c_1,c_2,\ldots,c_k$$$ ($$$1=c_1<c_2<\ldots<c_k\le n$$$) — the good indices. <span class="tex-font-style-bf">It is guaranteed that $$$1$$$ is always a good index (i.e. $$$c_1=1$$$)</span>.</p><p>It is guaranteed that the sum of $$$2^n$$$ over all test cases does not exceed $$$2^{20}$$$. </p><p>It is guaranteed that the sum of $$$m$$$ over all test cases does not exceed $$$10^6$$$. </p></div><div class="output-specification"><div class="section-title">Output</div><p>For each testcase, print a single integer — the sum of $$$x$$$ over all the possible <span class="tex-font-style-it">valid</span> configurations modulo $$$10 ^ 9 + 7$$$.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id006170224844883893" id="id00531483642403553" class="input-output-copier">Copy</div></div><pre id="id006170224844883893"><div class="test-example-line test-example-line-even test-example-line-0">5</div><div class="test-example-line test-example-line-odd test-example-line-1">2 3</div><div class="test-example-line test-example-line-odd test-example-line-1">1</div><div class="test-example-line test-example-line-odd test-example-line-1">1</div><div class="test-example-line test-example-line-even test-example-line-2">7 4</div><div class="test-example-line test-example-line-even test-example-line-2">3</div><div class="test-example-line test-example-line-even test-example-line-2">1 4 6</div><div class="test-example-line test-example-line-odd test-example-line-3">12 31</div><div class="test-example-line test-example-line-odd test-example-line-3">6</div><div class="test-example-line test-example-line-odd test-example-line-3">1 3 5 7 9 11</div><div class="test-example-line test-example-line-even test-example-line-4">11 121</div><div class="test-example-line test-example-line-even test-example-line-4">11</div><div class="test-example-line test-example-line-even test-example-line-4">1 2 3 4 5 6 7 8 9 10 11</div><div class="test-example-line test-example-line-odd test-example-line-5">19 6969</div><div class="test-example-line test-example-line-odd test-example-line-5">2</div><div class="test-example-line test-example-line-odd test-example-line-5">1 19</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id007092395575797584" id="id0013905014005855953" class="input-output-copier">Copy</div></div><pre id="id007092395575797584">18
33664
909076242
683044824
901058932
</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>For the first test case, the <span class="tex-font-style-it">valid</span> configurations are: $$$[1, 1]$$$, $$$[1,2]$$$, $$$[1, 3]$$$, $$$[2, 1]$$$, $$$[2, 2]$$$, $$$[2,3]$$$, $$$[3,1]$$$, $$$[3,2]$$$, $$$[3,3]$$$.</p><p>As there are only $$$2$$$ piles of stones, Alice can only choose the first pile and remove it. Thus, the sum of $$$x$$$ is equal to $$$1+1+1+2+2+2+3+3+3= 18$$$.</p></div>